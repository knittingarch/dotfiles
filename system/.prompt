# Git prompt functions (shell-agnostic)
function __git_dirty {
  git diff --quiet HEAD &>/dev/null
  [ $? == 1 ] && echo " [ðŸ’©]"
}

function __git_ps1 ()
{
   local b="$(git symbolic-ref HEAD 2>/dev/null)";
   if [ -n "$b" ]; then
       printf " (%s)" "${b##refs/heads/}";
   fi
}

function __git_branch {
  __git_ps1 "%s"
}

# Zsh-specific prompt configuration
if [ -n "$ZSH_VERSION" ]; then
  # Enable parameter expansion, command substitution and arithmetic expansion in prompts
  setopt PROMPT_SUBST

  # Zsh uses different color syntax
  autoload -U colors && colors

  # Define color shortcuts for easier use
  local BLACK=$fg[black]
  local RED=$fg[red]
  local GREEN=$fg[green]
  local YELLOW=$fg[yellow]
  local BLUE=$fg[blue]
  local MAGENTA=$fg[magenta]
  local CYAN=$fg[cyan]
  local WHITE=$fg[white]

  # Bold/emphasized colors for zsh
  local BOLD_BLACK=$fg_bold[black]
  local BOLD_RED=$fg_bold[red]
  local BOLD_GREEN=$fg_bold[green]
  local BOLD_YELLOW=$fg_bold[yellow]
  local BOLD_BLUE=$fg_bold[blue]
  local BOLD_MAGENTA=$fg_bold[magenta]
  local BOLD_CYAN=$fg_bold[cyan]
  local BOLD_WHITE=$fg_bold[white]

  # Background colors for zsh
  local BG_BLACK=$bg[black]
  local BG_RED=$bg[red]
  local BG_GREEN=$bg[green]
  local BG_YELLOW=$bg[yellow]
  local BG_BLUE=$bg[blue]
  local BG_MAGENTA=$bg[magenta]
  local BG_CYAN=$bg[cyan]
  local BG_WHITE=$bg[white]

  local RESET=$reset_color

  # Git integration for zsh
  autoload -Uz vcs_info
  precmd_vcs_info() { vcs_info }
  precmd_functions+=( precmd_vcs_info )
  setopt PROMPT_SUBST
  zstyle ':vcs_info:git:*' formats ' (%b)'
  zstyle ':vcs_info:*' enable git

  # Zsh prompt with 256-color palette
  PROMPT='%F{166}%m%f:%F{141}%~%f%F{244}$vcs_info_msg_0_%f%F{216}$(__git_dirty)%f $ '
else
  # Bash prompt configuration
  bash_prompt() {
    local NONE="\[\033[0m\]"    # unsets color to term's fg color

    # regular colors
    local K="\[\033[0;30m\]"    # black
    local R="\[\033[0;31m\]"    # red
    local G="\[\033[0;32m\]"    # green
    local Y="\[\033[0;33m\]"    # yellow
    local B="\[\033[0;34m\]"    # blue
    local M="\[\033[0;35m\]"    # magenta
    local C="\[\033[0;36m\]"    # cyan
    local W="\[\033[0;37m\]"    # white

    # emphasized (bolded) colors
    local EMK="\[\033[1;30m\]"
    local EMR="\[\033[1;31m\]"
    local EMG="\[\033[1;32m\]"
    local EMY="\[\033[1;33m\]"
    local EMB="\[\033[1;34m\]"
    local EMM="\[\033[1;35m\]"
    local EMC="\[\033[1;36m\]"
    local EMW="\[\033[1;37m\]"

    # background colors
    local BGK="\[\033[40m\]"
    local BGR="\[\033[41m\]"
    local BGG="\[\033[42m\]"
    local BGY="\[\033[43m\]"
    local BGB="\[\033[44m\]"
    local BGM="\[\033[45m\]"
    local BGC="\[\033[46m\]"
    local BGW="\[\033[47m\]"

    local UC=$W                 # user's color
    [ $UID -eq "0" ] && UC=$R   # root's color

    # Bash prompt with 256-color palette
    PS1="\[\033[38;5;166m\]\h\[\033[0m\]:\[\033[38;5;141m\]\w\[\033[38;5;244m\]\$(__git_branch)\[\033[38;5;216m\]\$(__git_dirty)\[\033[0m\] $ "
  }

  bash_prompt
  unset bash_prompt
fi
